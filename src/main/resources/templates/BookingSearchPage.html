<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Find Booking</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Code for smart Search bars --- ck -->
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <link rel="stylesheet" th:href="@{/css/style.css}">

</head>
<body>
<!--navbar-->
<div id="navbar-temp"> </div>
<script>
  $(function(){
    $("#navbar-temp").load("navbar.html");
  });
</script>
<!--<img th:src="@{/images/index_bg.jpeg}">-->
<div class="container" id="flightContainer">
  <h1 class="h1 text-center mt-3">Find Booking</h1>
  <form class="col-12, form my-3"  action="#"  th:action="@{/returnBooking}" method="post">
    <div class="col-10 my-4">
      <div class="input-group mb-3">
        <span class="input-group-text" id="2">Booking Reference: </span>
        <input type="text" class="form-control" name="bookingRef" th:value="${bookingRef}" aria-describedby="2" placeholder="1234567890"  id="bookingRef" required>
      </div>
    </div>
    <div class="row mb-3">
      <div class="col-10 my-1">
        <div class="input-group">
          <span class="input-group-text" id="3">Email: </span>
          <input type="text" class="form-control" name="email" th:value="${email}" aria-describedby="3" placeholder="email@email.com"  id="email" required>
        </div>
      </div>
    </div>
    <div class="d-grid gap-2">
      <button type="submit" class="btn btn-dark btn-lg">Search</button>
    </div>
  </form>
</div>

<table class="table" id="matchedBooking">
  <thead>
  <tr th:if="${ticketInfo.bookingRef=='nosearch'}">
  </tr>
  <tr th:if="${ticketInfo.bookingRef=='null'}">
    Wrong booking reference.
  </tr>
  <tr th:if="${ticketInfo.priceBought=='null'}">
    Hmmm...
    There seems to be a problem with the flight information! Please contact the airlines to sort this out.
  </tr>
  <tr class="table-active" th:if="${ticketInfo.bookingRef!='null'} and ${ticketInfo.bookingRef!='nosearch'} and ${ticketInfo.priceBought!='null'}">
    <th>flightInfo Number</th>
    <th>From</th>
    <th>To</th>
    <th>Departure Time</th>
    <th>Arrival Time</th>
    <th>Date</th>
    <th>Price</th>
  </tr>
  </thead>
  <tbody>
  <tr th:if="${ticketInfo.bookingRef =='null'}">
  </tr>
  <tr th:if="${ticketInfo.priceBought=='null'}">
  </tr>
  <tr th:if="${ticketInfo.bookingRef!='null'} and ${ticketInfo.bookingRef!='nosearch'} and ${ticketInfo.priceBought!='null'}">
    <td th:text="${flightInfo.flightNumber}">flightInfo Number</td>
    <td th:text="${flightInfo.from}">From</td>
    <td th:text="${flightInfo.to}">To</td>
    <!--                        <td th:text="${flightInfo.departureTime}">Departure Time</td>-->
    <td th:if="*{flightInfo.departureTime!=null and flightInfo.departureTime=='NA'}" th:text="${flightInfo.departureTime}">Departure Time</td>
    <td th:if="*{flightInfo.departureTime!=null and #strings.length(flightInfo.departureTime)==4 and flightInfo.departureTime!='NA'}" th:text="${#strings.substring(flightInfo.departureTime,0,2)} + ':'+${#strings.substring(flightInfo.departureTime,2,4)}">Departure Time</td>
    <td th:if="*{flightInfo.departureTime!=null and #strings.length(flightInfo.departureTime)==3 and flightInfo.departureTime!='NA'}" th:text="${#strings.substring(flightInfo.departureTime,0,1)} + ':'+${#strings.substring(flightInfo.departureTime,1,3)}">Departure Time</td>
    <td th:if="*{flightInfo.departureTime!=null and #strings.length(flightInfo.departureTime)<3 and flightInfo.departureTime!='NA'}" th:text="${flightInfo.departureTime}+':00'">Departure Time</td>

    <!--                        <td th:text="${flightInfo.arrivalTime}">Arrival Time</td>-->
    <td th:if="*{flightInfo.arrivalTime!=null and flightInfo.arrivalTime=='NA'}" th:text="${flightInfo.arrivalTime}">Arrival Time</td>
    <td th:if="*{flightInfo.arrivalTime!=null and #strings.length(flightInfo.arrivalTime)==4  and flightInfo.arrivalTime!='NA'}" th:text="${#strings.substring(flightInfo.arrivalTime,0,2)} + ':'+${#strings.substring(flightInfo.arrivalTime,2,4)}">Arrival Time</td>
    <td th:if="*{flightInfo.arrivalTime!=null and #strings.length(flightInfo.arrivalTime)==3 and flightInfo.arrivalTime!='NA'}" th:text="${#strings.substring(flightInfo.arrivalTime,0,1)} + ':'+${#strings.substring(flightInfo.arrivalTime,1,3)}">Arrival Time</td>
    <td th:if="*{flightInfo.arrivalTime!=null and #strings.length(flightInfo.arrivalTime)<3 and flightInfo.arrivalTime!='NA'}" th:text="${flightInfo.arrivalTime}+':00'">Arrival Time</td>

    <td th:text="${flightInfo.date}">Date</td>
    <td th:text="'Â£' + ${ticketInfo.priceBought}">Price</td>
  </tr>
  </tbody>
</table>

<table class="table" id="bookingInformatiom">
  <thead>
  <tr th:if="${ticketInfo.bookingRef=='null'}">
  </tr>
  <tr th:if="${ticketInfo.priceBought=='null'}">
  </tr>
  <tr class="table-active" th:if="${ticketInfo.bookingRef!='null'} and ${ticketInfo.bookingRef!='nosearch'} and ${ticketInfo.priceBought!='null'}">
    <th>Booking Reference</th>
    <th>Class</th>
    <th>Meal</th>
    <th>Insurance</th>
    <th>Luggage</th>
    <th>Age</th>
  </tr>
  </thead>
  <tbody>
  <tr th:if="${ticketInfo.bookingRef =='null'}">
  </tr>
  <tr th:if="${ticketInfo.priceBought=='null'}">
  </tr>
  <tr th:if="${ticketInfo.bookingRef!='null'} and ${ticketInfo.bookingRef!='nosearch'} and ${ticketInfo.priceBought!='null'}">
    <td th:text="${ticketInfo.bookingRef}">Booking Reference</td>
    <td th:text="${ticketInfo.seatClass}">Class</td>
    <td th:text="${ticketInfo.meal}">Meal</td>
    <td th:if="${ticketInfo.insurance!=null}" th:text="${ticketInfo.insurance}">Insurance</td>
    <td th:if="${ticketInfo.insurance==null}">NO</td>
    <td th:if="${ticketInfo.luggage!=null}" th:text="${ticketInfo.luggage}">Insurance</td>
    <td th:if="${ticketInfo.luggage==null}">NO</td>
    <td th:text="${ticketInfo.ageGroup}">Age</td>
  </tr>
  </tbody>
</table>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
</body>
</html>
