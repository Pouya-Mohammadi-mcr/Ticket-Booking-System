<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Checkout</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" th:href="@{/css/styleForCheckout.css}">
    <!-- Bootstrap CSS -->
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script type="text/javascript">
        function goBack() {
            window.history.back();
        }

        function addToPrice() {
            const radio_class = document.getElementsByName('radio_class');
            const radio_insurance = document.getElementsByName('radio_insurance');
            const quantity = document.getElementById('quantity').value;
            const thePrice = document.getElementById("hiddenPrice").innerHTML;
            var add = "";
            for (var i = 0, lengthC = radio_class.length; i < lengthC; i++) {
                // alert("Hello");
                if (radio_class[i].checked){
                    // alert("Hello");
                     add = +add + +radio_class[i].value;
                     break;
                }
            }
            for (var j = 0, lengthR = radio_insurance.length; j < lengthR; j++) {
                // alert("Hello");
                if (radio_insurance[j].checked){
                    // alert("Hello");
                    add = +add + +radio_insurance[j].value;
                    break;
                }
            }
            document.getElementById("finalPrice").value = (+add + +thePrice +quantity*20).toString();
            document.getElementById("price").innerHTML =  (+add + +thePrice +quantity*20).toString();

        }

    </script>

</head>
<body >

<h1>Ticket Builder</h1>
<div class="row">
    <div class="col-50">
        <div class="container">
            <!--    <h1 class="h1 text-center text-info mt-3">Find Flights</h1>-->
            <button type="button"  class="btn" onclick="goBack()" id="return">Go Back</button>
            <form id="extraInfo"  action="#" th:action="@{/setTicketInformation}"  method="post">
                <h3>Make Your Ticket</h3>
                <div class="row" >
                    <div class="col-50">
                        <label> <i class="fa fa-user"></i> Class</label>
                        <input type="radio" id="option1" name="radio_class" value="50"  onclick="addToPrice()"> First Class (+ £50)
<!--                        <label  for="option1">First Class (+ £50)</label>-->
                        <input type="radio" id="option2" name="radio_class" value="20"  onclick="addToPrice()"> Business Class (+ £20)
<!--                        <label  for="option2">Business Class (+ £20)</label>-->
                        <input type="radio" id="option3" name="radio_class"  value="0"  onclick="addToPrice()"> Economy Class
<!--                        <label  for="option3">Economy Class</label>-->
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-50">
                        <label ><i class="fa fa-life-ring"></i> Flight Insurance (+ £20)</label>
                        <input type="checkbox" id="option4" name="radio_insurance"  value="20" onclick="addToPrice()"> Add
<!--&lt;!&ndash;                        <label  for="option4">Yes</label>&ndash;&gt;-->
<!--                        <input type="radio" id="option5" name="radio_insurance"  value="0" onclick="addToPrice()" > No-->
<!--&lt;!&ndash;                        <label  for="option5">No</label>&ndash;&gt;-->
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-50">
                        <label><i class="fa fa-cutlery"></i> Meal (no extra cost)</label>
                        <input type="radio" id="option5" name="radio_meal"  value="omnivore"> Omnivore
<!--                        <label  for="option6">Omnivore</label>-->
                        <input type="radio" id="option6" name="radio_meal"  value="vegetarian" > Vegetarian
<!--                        <label  for="option7">Vegetarian</label>-->
                        <input type="radio" id="option7" name="radio_meal"  value="vegan" > Vegan
<!--                        <label  for="option8">Vegan</label>-->
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-50">
                        <label for="quantity"><i class="fa fa-suitcase"></i> Luggage Quantity (each is + £20)</label>
                        <input type="number" id="quantity" name="luggage" value="0" onchange="addToPrice()"  min="0" max="5">
                    </div>
                    <div hidden class="col-50">
                        <input id="finalPrice" name="finalPrice" value="">
                    </div>
                    <button class="btn btn-primary" id="btn-ticket" type="submit">Add Ticket</button>
                </div>
            </form>
        </div>
    </div>
    <div class="col-25">
        <div class="container">
            <h4>Your Flight<span class="price" style="color:black" th:text=" 'ID: '+${flight.id}" th:value="${flight.id}" id="flightId">ID: </span> <i class="fa fa-plane"></i></h4>
            <hr>
            <p>From: <b th:text="${flight.from}" ></b></p>
            <p>To: <b th:text="${flight.to}"></b></p>
            <p>Date: <b th:text="${flight.date}"></b> </p>
            <p>Departure:
                <b th:if="*{flight.departureTime!=null and flight.departureTime=='NA'}" th:text="${flight.departureTime}"></b>
                <b th:if="*{flight.departureTime!=null and #strings.length(flight.departureTime)==4 and flight.departureTime!='NA'}" th:text="${#strings.substring(flight.departureTime,0,2)} + ':'+${#strings.substring(flight.departureTime,2,4)}"></b>
                <b th:if="*{flight.departureTime!=null and #strings.length(flight.departureTime)==3 and flight.departureTime!='NA'}" th:text="${#strings.substring(flight.departureTime,0,1)} + ':'+${#strings.substring(flight.departureTime,1,3)}"></b>
                <b th:if="*{flight.departureTime!=null and #strings.length(flight.departureTime)<3 and flight.departureTime!='NA'}" th:text="${flight.departureTime}+':00'"></b>
            </p>
            <p>Arrival:
                <b th:if="*{flight.arrivalTime!=null and flight.arrivalTime=='NA'}" th:text="${flight.arrivalTime}"></b>
                <b th:if="*{flight.arrivalTime!=null and #strings.length(flight.arrivalTime)==4 and flight.arrivalTime!='NA'}" th:text="${#strings.substring(flight.arrivalTime,0,2)} + ':'+${#strings.substring(flight.arrivalTime,2,4)}"></b>
                <b th:if="*{flight.arrivalTime!=null and #strings.length(flight.arrivalTime)==3 and flight.arrivalTime!='NA'}" th:text="${#strings.substring(flight.arrivalTime,0,1)} + ':'+${#strings.substring(flight.arrivalTime,1,3)}"></b>
                <b th:if="*{flight.arrivalTime!=null and #strings.length(flight.arrivalTime)<3 and flight.arrivalTime!='NA'}" th:text="${flight.arrivalTime}+':00'"></b>
            </p>
            <hr>
            <p>
                Total
                <span  class="price" style="color:black">
                    £<b id="price" th:text=" ${flight.price} "></b>
                </span>
            </p>
            <p hidden>
                Total
                <span  class="price" style="color:black">
                    £<b id="hiddenPrice" th:text=" ${flight.price} "></b>
                </span>
            </p>

        </div>
    </div>
</div>
<button class="btn btn-primary" style="float: right" id="btn-pay" onclick="document.getElementById('extraInfo').submit();" type="submit">Pay</button>


</body>
</html>
